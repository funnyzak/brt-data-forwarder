# 服务器配置
server:
  host: "0.0.0.0"
  port: 8080
  debug: false

# 数据接收配置
receiver:
  path: "/receive_brt_data"

  # 认证配置
  auth:
    enabled: true
    query_param: "auth_token"        # URL参数名
    header: "Authorization"           # HTTP头名
    valid_tokens:                     # 有效token列表
      - "your-secret-token-123"


# 数据处理配置
processing:
  enabled: true                      # 是否启用数据处理（默认开启）
                                      # false=直接转发原始数据，但仍更新缓存

# 时间戳配置
timestamp:
  reset_on_receive: true            # 是否重置时间戳为接收时间
                                      # true: 将指定字段的时间戳重置为当前接收时间
                                      # false: 保持原始时间戳不变
  reset_fields:                      # 需要重置的时间字段列表
    - "time"                         # 网关上报时间（根级字段）
    - "scan_time"                    # 设备扫描时间（设备级字段）
  add_receive_timestamp: true        # 是否添加接收时间戳字段
                                      # true: 在数据中添加接收时间戳便于追踪
                                      # false: 不添加新的时间戳字段
  receive_timestamp_field: "received_at"  # 接收时间戳字段名
  
# 转发配置
forwarder:
  # 转发目标列表
  targets:
    - url: "http://192.168.0.120/post_data"
      timeout: 5                      # 超时时间（秒）
    - url: "http://192.168.0.121/api/data?abc=123"
      timeout: 5

  # 重试配置
  retry:
    enabled: true
    max_attempts: 1                   # 失败后重试次数

# 缓存配置
cache:
  # 缓存类型（目前支持 memory）
  type: "memory"

  # 持久化文件路径
  file_path: "./data/cache.json"

  # 自动同步间隔（秒）
  # 较小的间隔会减少数据丢失风险，但增加I/O操作
  # 较大的间隔会减少I/O操作，但增加数据丢失风险
  sync_interval: 30

  # 需要缓存的特殊指标
  # 这些指标的无效值会被上次有效值替换
  special_metrics:
    - co2        # 二氧化碳浓度
    - hcho       # 甲醛浓度
    - lux        # 光照强度
    - uva_class  # UVA等级
    - uva_raw    # UVA原始值
    - voc        # 挥发性有机化合物

  # 无效值模式（大小写不敏感）
  # 当传感器返回这些值时，会使用缓存值替换
  invalid_patterns:
    - "FFFF"     # 无效值模式1
    - "FFFE"     # 无效值模式2

# 日志配置
logging:
  level: "INFO"                       # DEBUG, INFO, WARNING, ERROR
  file_path: "./logs/forwarder.log"
  max_bytes: 10485760                 # 10MB
  backup_count: 7                     # 保留7个备份文件
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"